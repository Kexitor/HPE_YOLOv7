# Human pose estimation and classification using YOLOv7

This programm classifies poses (walk, fall, fallen, sitting) using Mediapipe for human pose estimation. This programm prototype can classify several persons in one frame. With 37 training videos and 11 test videos it showed about 89% of accuracy on classyfing fall, fallen and walking poses and about 22 FPS on RTX 3060 12GB and i5 12400F.

Example of work: 



https://github.com/Kexitor/HPE_YOLOv7/assets/55799671/2dbf5a5d-7f5b-4fc2-8be0-469752a709cc



## To launch this YOLOv7 required:
```
git clone https://github.com/WongKinYiu/yolov7.git
```

Firtsly it is better to clone YOLOv7 by upper link and install requirements.txt and after that overwrite that cloned repo with my files.

Or just install requirements by this command:

```
pip install -r requirements.txt
```

This file needed in main directory: https://github.com/WongKinYiu/yolov7/releases/download/v0.1/yolov7-w6-pose.pt

It is better to use the GPU to work with a program prototype.

## Used videos for training and testing:

https://www.youtube.com/watch?v=8Rhimam6FgQ

http://fenix.ur.edu.pl/mkepski/ds/uf.html

## Used lib versions:

Python==3.7.8

matplotlib>=3.2.2

numpy>=1.18.5,<1.24.0

opencv-python>=4.1.1

Pillow>=7.1.2

PyYAML>=5.3.1

requests>=2.23.0

scipy>=1.4.1

torch>=1.7.0,!=1.12.0

torchvision>=0.8.1,!=0.13.0

tqdm>=4.41.0

protobuf<4.21.3

tensorboard>=2.4.1

pandas>=1.1.4

seaborn>=0.11.0

scikit-learn==1.0.2



## How to use:

`data_generator_mv.py` used to make data for training. Also by this file is used `data_lists.py` and numerous of videos to generate CSV file data. All params for generating CSV are in code.


Example of usage:
```
python data_generator_mv.py
```
`pose_estimator_yolo.py` is used to classify pose of person on video. This file uses CSV generated by previos command. In current version file `pickle_model37VTrD.pkl` already contains training data. If you want train model by yourself uncomment lines 18-19. Training by using MLPClassifier can take long time depending on dataset size and CPU. Data paths can be changed in code.

Example of usage:
```
python pose_estimator_yolo.py -i videos\50wtf.mp4
```


You can check my other prototypes: 

https://github.com/Kexitor/HPE_Mediapipe

https://github.com/Kexitor/HPE_Torchvision


